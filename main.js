/*! For license information please see main.js.LICENSE.txt */
(()=>{"use strict";function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===_typeof(i)?i:String(i)),o)}var n,i}var e=function(){function Component(e,t,r){!function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Component),this._template=r,this._events=t,this._container=e}return function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Component,[{key:"template",get:function get(){return this._template}},{key:"container",get:function get(){return this._container}},{key:"events",get:function get(){return this._events}},{key:"toggleClass",value:function toggleClass(e,t,r){e.classList.toggle(t,r)}},{key:"setText",value:function setText(e,t){e&&(e.textContent=String(t))}},{key:"setDisabled",value:function setDisabled(e,t){e&&(t?e.setAttribute("disabled","disabled"):e.removeAttribute("disabled"))}},{key:"setHidden",value:function setHidden(e){e.style.display="none"}},{key:"setVisible",value:function setVisible(e){e.style.removeProperty("display")}},{key:"setImage",value:function setImage(e,t,r){e&&(e.src=t,r&&(e.alt=r))}},{key:"render",value:function render(e){return Object.assign(this,null!=e?e:{}),this.container}}]),Component}(),t="".concat("","/api/weblarek"),r="".concat("","/content/weblarek");function products_view_typeof(e){return products_view_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},products_view_typeof(e)}function products_view_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function products_view_toPrimitive(e,t){if("object"!==products_view_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==products_view_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===products_view_typeof(i)?i:String(i)),o)}var n,i}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=_getPrototypeOf(e);if(t){var n=_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function _possibleConstructorReturn(e,t){if(t&&("object"===products_view_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}(this,r)}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}var o,n,__classPrivateFieldGet=function(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},i=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(ProductsView,e);var t=_createSuper(ProductsView);function ProductsView(e,r,n){var i;return function products_view_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ProductsView),i=t.call(this,e,r,n),o.add(_assertThisInitialized(i)),i}return function products_view_createClass(e,t,r){return t&&products_view_defineProperties(e.prototype,t),r&&products_view_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ProductsView,[{key:"renderProduct",value:function renderProduct(e){var t=this,i=this._template.cloneNode(!0);this.setText(i.querySelector(".card__title"),e.title),this.setImage(i.querySelector(".card__image"),r+e.image),this.setText(i.querySelector(".card__category"),e.category),this.setText(i.querySelector(".card__price"),e.price?e.price+" синапсов":"Бесценно"),this._container.setAttribute("id",e.id),i.addEventListener("click",(function(){__classPrivateFieldGet(t,o,"m",n).call(t,e.id)})),this.container.appendChild(i)}},{key:"items",set:function set(e){var t=this;this.container.innerHTML="",e.forEach((function(e){t.renderProduct(e)}))}}]),ProductsView}(e);function api_typeof(e){return api_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},api_typeof(e)}function api_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function api_toPrimitive(e,t){if("object"!==api_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==api_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===api_typeof(i)?i:String(i)),o)}var n,i}o=new WeakSet,n=function _ProductsView_handleProductClick(e){this._events.emit("card:open",{id:e})};var a=new(function(){function Api(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function api_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Api),this.baseUrl=e,this.options={headers:Object.assign({"Content-Type":"application/json"},null!==(t=r.headers)&&void 0!==t?t:{})}}return function api_createClass(e,t,r){return t&&api_defineProperties(e.prototype,t),r&&api_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Api,[{key:"handleResponse",value:function handleResponse(e){return e.ok?e.json():e.json().then((function(t){var r;return Promise.reject(null!==(r=t.error)&&void 0!==r?r:e.statusText)}))}},{key:"get",value:function get(e){return console.log(this.baseUrl+e),fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:"GET"})).then(this.handleResponse)}},{key:"post",value:function post(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST";return fetch(this.baseUrl+e,Object.assign(Object.assign({},this.options),{method:r,body:JSON.stringify(t)})).then(this.handleResponse)}}]),Api}())(t,{});function products_model_typeof(e){return products_model_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},products_model_typeof(e)}function _regeneratorRuntime(){_regeneratorRuntime=function _regeneratorRuntime(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function define(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var i=t&&t.prototype instanceof Generator?t:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(e,r,c)}),a}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=wrap;var u={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var l={};define(l,i,(function(){return this}));var s=Object.getPrototypeOf,f=s&&s(s(values([])));f&&f!==t&&r.call(f,i)&&(l=f);var p=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(l);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(o,n,i,a){var c=tryCatch(e[o],e,n);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==products_model_typeof(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){invoke("next",e,i,a)}),(function(e){invoke("throw",e,i,a)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return invoke("throw",e,i,a)}))}a(c.arg)}var n;o(this,"_invoke",{value:function value(e,r){function callInvokeWithMethodAndArg(){return new t((function(t,o){invoke(e,r,t,o)}))}return n=n?n.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,t,r){var o="suspendedStart";return function(n,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw i;return doneResult()}for(r.method=n,r.arg=i;;){var a=r.delegate;if(a){var c=maybeInvokeDelegate(a,r);if(c){if(c===u)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var l=tryCatch(e,t,r);if("normal"===l.type){if(o=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o="completed",r.method="throw",r.arg=l.arg)}}}function maybeInvokeDelegate(e,t){var r=t.method,o=e.iterator[r];if(void 0===o)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,maybeInvokeDelegate(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=tryCatch(o,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function next(){for(;++o<e.length;)if(r.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=void 0,next.done=!0,next};return n.next=n}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(p,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e},e.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,o,n,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,o,n),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},defineIteratorMethods(p),define(p,c,"Generator"),define(p,i,(function(){return this})),define(p,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var o in t)r.push(o);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var t=this;function handle(r,o){return i.type="throw",i.arg=e,t.next=r,o&&(t.method="next",t.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],i=n.completion;if("root"===n.tryLoc)return handle("end");if(n.tryLoc<=this.prev){var a=r.call(n,"catchLoc"),c=r.call(n,"finallyLoc");if(a&&c){if(this.prev<n.catchLoc)return handle(n.catchLoc,!0);if(this.prev<n.finallyLoc)return handle(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return handle(n.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return handle(n.finallyLoc)}}}},abrupt:function abrupt(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),u}},catch:function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var o=r.completion;if("throw"===o.type){var n=o.arg;resetTryEntry(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(e,t,r){return this.delegate={iterator:values(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function asyncGeneratorStep(e,t,r,o,n,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(o,n)}function _asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function _next(e){asyncGeneratorStep(i,o,n,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(i,o,n,_next,_throw,"throw",e)}_next(void 0)}))}}function products_model_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function products_model_toPrimitive(e,t){if("object"!==products_model_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==products_model_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===products_model_typeof(i)?i:String(i)),o)}var n,i}var c=function(){function ProductsModel(e){!function products_model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ProductsModel),this._events=e,this.getItems=function(){var e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee(e){var t;return _regeneratorRuntime().wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,a.get(e);case 3:return t=r.sent,r.abrupt("return",t);case 7:return r.prev=7,r.t0=r.catch(0),console.error("Error fetching items from API:",r.t0),r.abrupt("return",[]);case 11:case"end":return r.stop()}}),_callee,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}(),this.initializeProducts()}var e;return function products_model_createClass(e,t,r){return t&&products_model_defineProperties(e.prototype,t),r&&products_model_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ProductsModel,[{key:"initializeProducts",value:(e=_asyncToGenerator(_regeneratorRuntime().mark((function _callee2(){return _regeneratorRuntime().wrap((function _callee2$(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.getItems("/product/");case 3:this._products=e.sent,this._events.emit("products:get",this._products),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error("Error fetching products:",e.t0);case 10:case"end":return e.stop()}}),_callee2,this,[[0,7]])}))),function initializeProducts(){return e.apply(this,arguments)})},{key:"events",get:function get(){return this._events}},{key:"products",get:function get(){return this._products}}]),ProductsModel}();function events_typeof(e){return events_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},events_typeof(e)}function events_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function events_toPrimitive(e,t){if("object"!==events_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==events_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===events_typeof(i)?i:String(i)),o)}var n,i}var u=function(){function EventEmitter(){!function events_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,EventEmitter),this._events=new Map}return function events_createClass(e,t,r){return t&&events_defineProperties(e.prototype,t),r&&events_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(EventEmitter,[{key:"on",value:function on(e,t){var r;this._events.has(e)||this._events.set(e,new Set),null===(r=this._events.get(e))||void 0===r||r.add(t)}},{key:"off",value:function off(e,t){var r;this._events.has(e)&&(this._events.get(e).delete(t),0===(null===(r=this._events.get(e))||void 0===r?void 0:r.size)&&this._events.delete(e))}},{key:"emit",value:function emit(e,t){this._events.forEach((function(r,o){"*"===o&&r.forEach((function(r){return r({eventName:e,data:t})})),(o instanceof RegExp&&o.test(e)||o===e)&&r.forEach((function(e){return e(t)}))}))}},{key:"onAll",value:function onAll(e){this.on("*",e)}},{key:"offAll",value:function offAll(){this._events=new Map}},{key:"trigger",value:function trigger(e,t){var r=this;return function(){var o=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r.emit(e,Object.assign(Object.assign({},o||{}),t||{}))}}}]),EventEmitter}();function isSelector(e){return"string"==typeof e&&e.length>1}function ensureElement(e,t){if(isSelector(e)){var r=function ensureAllElements(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document;if(isSelector(e))return Array.from(t.querySelectorAll(e));if(e instanceof NodeList)return Array.from(e);if(Array.isArray(e))return e;throw new Error("Unknown selector element")}(e,t);if(r.length>1&&console.warn("selector ".concat(e," return more then one element")),0===r.length)throw new Error("selector ".concat(e," return nothing"));return r.pop()}if(e instanceof HTMLElement)return e;throw new Error("Unknown selector element")}function cloneTemplate(e){return ensureElement(e).content.firstElementChild.cloneNode(!0)}function Modal_typeof(e){return Modal_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Modal_typeof(e)}function Modal_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function Modal_toPrimitive(e,t){if("object"!==Modal_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==Modal_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===Modal_typeof(i)?i:String(i)),o)}var n,i}function Modal_setPrototypeOf(e,t){return Modal_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},Modal_setPrototypeOf(e,t)}function Modal_createSuper(e){var t=function Modal_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=Modal_getPrototypeOf(e);if(t){var n=Modal_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function Modal_possibleConstructorReturn(e,t){if(t&&("object"===Modal_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function Modal_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function Modal_getPrototypeOf(e){return Modal_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},Modal_getPrototypeOf(e)}var l,s=function(e){!function Modal_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Modal_setPrototypeOf(e,t)}(Modal,e);var t=Modal_createSuper(Modal);function Modal(e,r,o){var n;return function Modal_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Modal),(n=t.call(this,e,r,o)).initializeEventListeners=function(){document.body.addEventListener("click",n.handleBodyClick),n.closeButton=n.modalContainer.querySelector(".modal__close"),n.closeButton&&n.closeButton.addEventListener("click",n.handleCloseButtonClick)},n.handleCloseButtonClick=function(){n.closeModal()},n.handleBodyClick=function(e){e.target===n.closeButton&&e.stopPropagation(),e.target===n.modalContainer&&n.closeModal()},n.closeModal=function(){document.body.style.overflow="auto",n.toggleClass(n.modalContainer,"modal_active"),document.body.removeEventListener("click",n.handleBodyClick),n.closeButton&&n.closeButton.removeEventListener("click",n.handleCloseButtonClick),n._container.innerHTML=""},n.openModal=function(){var e=window.scrollY||document.documentElement.scrollTop||0,t=window.scrollX||document.documentElement.scrollLeft||0;n.modalContainer.style.top="".concat(e,"px"),n.modalContainer.style.left="".concat(t,"px"),document.body.style.overflow="hidden",n.toggleClass(n.modalContainer,"modal_active"),n.initializeEventListeners()},n.modalContainer=e,n}return function Modal_createClass(e,t,r){return t&&Modal_defineProperties(e.prototype,t),r&&Modal_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Modal)}(e);function card_view_typeof(e){return card_view_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},card_view_typeof(e)}function card_view_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function card_view_toPrimitive(e,t){if("object"!==card_view_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==card_view_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===card_view_typeof(i)?i:String(i)),o)}var n,i}function card_view_setPrototypeOf(e,t){return card_view_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},card_view_setPrototypeOf(e,t)}function card_view_createSuper(e){var t=function card_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=card_view_getPrototypeOf(e);if(t){var n=card_view_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function card_view_possibleConstructorReturn(e,t){if(t&&("object"===card_view_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function card_view_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function card_view_getPrototypeOf(e){return card_view_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},card_view_getPrototypeOf(e)}!function(e){e.Add="add",e.Remove="remove"}(l||(l={}));var f=function(e){!function card_view_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&card_view_setPrototypeOf(e,t)}(CardView,e);var t=card_view_createSuper(CardView);function CardView(e,r,o){var n;return function card_view_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardView),(n=t.call(this,e,r,o)).isInCart=!1,n.handleButtonClick=function(){var e=n.isInCart?l.Remove:l.Add;n.toggleCartState(e)},n._container=e.querySelector(".modal__content"),n}return function card_view_createClass(e,t,r){return t&&card_view_defineProperties(e.prototype,t),r&&card_view_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CardView,[{key:"setInCart",value:function setInCart(e){this.isInCart=e,this._button=this._container.querySelector(".card__button"),this.updateButton()}},{key:"renderLoading",value:function renderLoading(){this.setHidden(this._container),this._container.appendChild(this.template)}},{key:"stopLoading",value:function stopLoading(){this.setVisible(this._container)}},{key:"id",get:function get(){return this._id},set:function set(e){this._id=e}},{key:"title",set:function set(e){this.setText(this._container.querySelector(".card__title"),e)}},{key:"description",set:function set(e){this.setText(this._container.querySelector(".card__text"),e)}},{key:"category",set:function set(e){this.setText(this._container.querySelector(".card__category"),e)}},{key:"price",set:function set(e){var t=this._container.querySelector(".card__price");e?(this.setText(t,"".concat(e," синапсов")),this.setDisabled(this._button,!1)):(this.setText(t,"Бесценно"),this.setDisabled(this._button,!0))}},{key:"image",set:function set(e){this.setImage(this._container.querySelector(".card__image"),r+e)}},{key:"toggleCartState",value:function toggleCartState(e){this.isInCart=e===l.Add;var t=this.isInCart?"Убрать из корзины":"В корзину";this.updateButton(t),this._events.emit("cart:".concat(e),{id:this.id})}},{key:"updateButton",value:function updateButton(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isInCart?"Убрать из корзины":"В корзину";this._button&&(this._button.textContent=e,this._button.removeEventListener("click",this.handleButtonClick),this._button.addEventListener("click",this.handleButtonClick))}}]),CardView}(s);function cart_model_typeof(e){return cart_model_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cart_model_typeof(e)}function cart_model_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cart_model_toPrimitive(e,t){if("object"!==cart_model_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cart_model_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cart_model_typeof(i)?i:String(i)),o)}var n,i}var p=function(){function CartModel(e){!function cart_model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CartModel),this._events=e,this._products=[],this._total=0}return function cart_model_createClass(e,t,r){return t&&cart_model_defineProperties(e.prototype,t),r&&cart_model_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CartModel,[{key:"events",get:function get(){return this._events}},{key:"products",get:function get(){return this._products}},{key:"total",get:function get(){return this._total}},{key:"clear",value:function clear(){this._products=[],this._total=0}},{key:"add",value:function add(e){this._products.push(e),this._total+=e.price}},{key:"remove",value:function remove(e){this._total-=this.products.find((function(t){return t.id===e})).price,this._products=this._products.filter((function(t){return t.id!==e}))}}]),CartModel}();function card_model_typeof(e){return card_model_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},card_model_typeof(e)}function card_model_regeneratorRuntime(){card_model_regeneratorRuntime=function _regeneratorRuntime(){return e};var e={},t=Object.prototype,r=t.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},n="function"==typeof Symbol?Symbol:{},i=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",c=n.toStringTag||"@@toStringTag";function define(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(e){define=function define(e,t,r){return e[t]=r}}function wrap(e,t,r,n){var i=t&&t.prototype instanceof Generator?t:Generator,a=Object.create(i.prototype),c=new Context(n||[]);return o(a,"_invoke",{value:makeInvokeMethod(e,r,c)}),a}function tryCatch(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=wrap;var u={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var l={};define(l,i,(function(){return this}));var s=Object.getPrototypeOf,f=s&&s(s(values([])));f&&f!==t&&r.call(f,i)&&(l=f);var p=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(l);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(o,n,i,a){var c=tryCatch(e[o],e,n);if("throw"!==c.type){var u=c.arg,l=u.value;return l&&"object"==card_model_typeof(l)&&r.call(l,"__await")?t.resolve(l.__await).then((function(e){invoke("next",e,i,a)}),(function(e){invoke("throw",e,i,a)})):t.resolve(l).then((function(e){u.value=e,i(u)}),(function(e){return invoke("throw",e,i,a)}))}a(c.arg)}var n;o(this,"_invoke",{value:function value(e,r){function callInvokeWithMethodAndArg(){return new t((function(t,o){invoke(e,r,t,o)}))}return n=n?n.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}})}function makeInvokeMethod(e,t,r){var o="suspendedStart";return function(n,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===n)throw i;return doneResult()}for(r.method=n,r.arg=i;;){var a=r.delegate;if(a){var c=maybeInvokeDelegate(a,r);if(c){if(c===u)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===o)throw o="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o="executing";var l=tryCatch(e,t,r);if("normal"===l.type){if(o=r.done?"completed":"suspendedYield",l.arg===u)continue;return{value:l.arg,done:r.done}}"throw"===l.type&&(o="completed",r.method="throw",r.arg=l.arg)}}}function maybeInvokeDelegate(e,t){var r=t.method,o=e.iterator[r];if(void 0===o)return t.delegate=null,"throw"===r&&e.iterator.return&&(t.method="return",t.arg=void 0,maybeInvokeDelegate(e,t),"throw"===t.method)||"return"!==r&&(t.method="throw",t.arg=new TypeError("The iterator does not provide a '"+r+"' method")),u;var n=tryCatch(o,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,u;var i=n.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,u):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,u)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,n=function next(){for(;++o<e.length;)if(r.call(e,o))return next.value=e[o],next.done=!1,next;return next.value=void 0,next.done=!0,next};return n.next=n}}return{next:doneResult}}function doneResult(){return{value:void 0,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,o(p,"constructor",{value:GeneratorFunctionPrototype,configurable:!0}),o(GeneratorFunctionPrototype,"constructor",{value:GeneratorFunction,configurable:!0}),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,c,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e},e.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,a,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,r,o,n,i){void 0===i&&(i=Promise);var a=new AsyncIterator(wrap(t,r,o,n),i);return e.isGeneratorFunction(r)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},defineIteratorMethods(p),define(p,c,"Generator"),define(p,i,(function(){return this})),define(p,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=Object(e),r=[];for(var o in t)r.push(o);return r.reverse(),function next(){for(;r.length;){var e=r.pop();if(e in t)return next.value=e,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function reset(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(resetTryEntry),!e)for(var t in this)"t"===t.charAt(0)&&r.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function stop(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function dispatchException(e){if(this.done)throw e;var t=this;function handle(r,o){return i.type="throw",i.arg=e,t.next=r,o&&(t.method="next",t.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o],i=n.completion;if("root"===n.tryLoc)return handle("end");if(n.tryLoc<=this.prev){var a=r.call(n,"catchLoc"),c=r.call(n,"finallyLoc");if(a&&c){if(this.prev<n.catchLoc)return handle(n.catchLoc,!0);if(this.prev<n.finallyLoc)return handle(n.finallyLoc)}else if(a){if(this.prev<n.catchLoc)return handle(n.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return handle(n.finallyLoc)}}}},abrupt:function abrupt(e,t){for(var o=this.tryEntries.length-1;o>=0;--o){var n=this.tryEntries[o];if(n.tryLoc<=this.prev&&r.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,u):this.complete(a)},complete:function complete(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),u},finish:function finish(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),resetTryEntry(r),u}},catch:function _catch(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var o=r.completion;if("throw"===o.type){var n=o.arg;resetTryEntry(r)}return n}}throw new Error("illegal catch attempt")},delegateYield:function delegateYield(e,t,r){return this.delegate={iterator:values(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=void 0),u}},e}function card_model_asyncGeneratorStep(e,t,r,o,n,i,a){try{var c=e[i](a),u=c.value}catch(e){return void r(e)}c.done?t(u):Promise.resolve(u).then(o,n)}function card_model_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function card_model_toPrimitive(e,t){if("object"!==card_model_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==card_model_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===card_model_typeof(i)?i:String(i)),o)}var n,i}var d=function(){function CardModel(e){!function card_model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CardModel),this._events=e}var e;return function card_model_createClass(e,t,r){return t&&card_model_defineProperties(e.prototype,t),r&&card_model_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CardModel,[{key:"product",get:function get(){return this._product}},{key:"events",get:function get(){return this._events}},{key:"getCard",value:(e=function card_model_asyncToGenerator(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function _next(e){card_model_asyncGeneratorStep(i,o,n,_next,_throw,"next",e)}function _throw(e){card_model_asyncGeneratorStep(i,o,n,_next,_throw,"throw",e)}_next(void 0)}))}}(card_model_regeneratorRuntime().mark((function _callee(e){return card_model_regeneratorRuntime().wrap((function _callee$(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",a.get("/product/"+e));case 1:case"end":return t.stop()}}),_callee)}))),function getCard(t){return e.apply(this,arguments)})},{key:"buyProduct",value:function buyProduct(){throw new Error("Method not implemented.")}},{key:"deleteProduct",value:function deleteProduct(){throw new Error("Method not implemented.")}}]),CardModel}();function cart_view_typeof(e){return cart_view_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},cart_view_typeof(e)}function cart_view_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function cart_view_toPrimitive(e,t){if("object"!==cart_view_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==cart_view_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===cart_view_typeof(i)?i:String(i)),o)}var n,i}function cart_view_setPrototypeOf(e,t){return cart_view_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},cart_view_setPrototypeOf(e,t)}function cart_view_createSuper(e){var t=function cart_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=cart_view_getPrototypeOf(e);if(t){var n=cart_view_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function cart_view_possibleConstructorReturn(e,t){if(t&&("object"===cart_view_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return cart_view_assertThisInitialized(e)}(this,r)}}function cart_view_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cart_view_getPrototypeOf(e){return cart_view_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},cart_view_getPrototypeOf(e)}var y,h,v,_,m,b,cart_view_classPrivateFieldGet=function(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},w=".modal__content",g=".header__basket",P=".basket__list",S=".button",k=".card__title",O=".basket__item-index",C=".card__price",E=".basket__item-delete",j=".card_compact",x=".basket__price",T=function(e){!function cart_view_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&cart_view_setPrototypeOf(e,t)}(CartView,e);var t=cart_view_createSuper(CartView);function CartView(e,r,o){var n;return function cart_view_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,CartView),n=t.call(this,e,r,o),y.add(cart_view_assertThisInitialized(n)),_.set(cart_view_assertThisInitialized(n),(function(){n._events.emit("cart:open"),n.container.innerHTML="",n._container.appendChild(n._template)})),m.set(cart_view_assertThisInitialized(n),(function(e){var t=e.target.closest(j).id;n._events.emit("cart:remove",{id:t})})),b.set(cart_view_assertThisInitialized(n),(function(){n.closeModal(),n._events.emit("order:create")})),n._container=e.querySelector(w),n._headerCart=document.querySelector(g),n._headerCart.addEventListener("click",cart_view_classPrivateFieldGet(cart_view_assertThisInitialized(n),_,"f")),n}return function cart_view_createClass(e,t,r){return t&&cart_view_defineProperties(e.prototype,t),r&&cart_view_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(CartView,[{key:"products",set:function set(e){cart_view_classPrivateFieldGet(this,y,"m",h).call(this,e)}},{key:"removeCard",value:function removeCard(e){var t=this,r=this.template.querySelector(P);if(r){var o=r.querySelector("#".concat(CSS.escape(e)));o&&o.remove(),r.querySelectorAll(j).forEach((function(e,r){t.setText(e.querySelector(".basket__item-index"),r+1)}))}}},{key:"update",value:function update(e,t){this.setText(this._headerCart.querySelector(".header__basket-counter"),e),this.setText(this._container.querySelector(x),t+" синапсов"),0===e?this.setDisabled(this._orderButton,!0):this.setDisabled(this._orderButton,!1)}}]),CartView}(s);function form_view_typeof(e){return form_view_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},form_view_typeof(e)}function form_view_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function form_view_toPrimitive(e,t){if("object"!==form_view_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==form_view_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===form_view_typeof(i)?i:String(i)),o)}var n,i}function form_view_setPrototypeOf(e,t){return form_view_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},form_view_setPrototypeOf(e,t)}function form_view_createSuper(e){var t=function form_view_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=form_view_getPrototypeOf(e);if(t){var n=form_view_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function form_view_possibleConstructorReturn(e,t){if(t&&("object"===form_view_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function form_view_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}function form_view_getPrototypeOf(e){return form_view_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},form_view_getPrototypeOf(e)}_=new WeakMap,m=new WeakMap,b=new WeakMap,y=new WeakSet,h=function _CartView_renderCart(e){var t=this,r=this.template.querySelector(P);r.innerHTML="",e.forEach((function(e,o){cart_view_classPrivateFieldGet(t,y,"m",v).call(t,e,o,r)})),this._container.appendChild(this._template),this._orderButton=document.querySelector(S),this._orderButton.addEventListener("click",cart_view_classPrivateFieldGet(this,b,"f"))},v=function _CartView_renderCartItem(e,t,r){var o=cloneTemplate("#card-basket");this.setText(o.querySelector(k),e.title),this.setText(o.querySelector(C),e.price),this.setText(o.querySelector(O),t+1),r.appendChild(o),o.setAttribute("id",e.id),this._trashButton=o.querySelector(E),this._trashButton.addEventListener("click",cart_view_classPrivateFieldGet(this,m,"f"))};var M=function(e){!function form_view_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&form_view_setPrototypeOf(e,t)}(FormView,e);var t=form_view_createSuper(FormView);function FormView(e,r,o,n){var i;return function form_view_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FormView),(i=t.call(this,e,r,o)).actionButton=n,i.resetForm=function(e,t){i._template=e,i.actionButton=t},i.changeForm=function(e,t){i.resetForm(e,t),i.closeModal()},i.renderForm=function(){return i.openModal(),i._container.innerHTML="",i._container.appendChild(i._template),i.initFormElements(),i.initPaymentButtons(),i.initActionButton(),i.formControls=i._container.querySelector(".order__buttons"),i._container},i.initFormElements=function(){i.formElements=i._container.querySelectorAll(".form__input"),i.formElements.forEach((function(e){e.value="",e.addEventListener("input",i.handleFormElementInput)}))},i.initPaymentButtons=function(){i._container.querySelectorAll(".button_alt").forEach((function(e){e.setAttribute("checked","false"),e.classList.remove("button_alt-active"),e.addEventListener("click",i.handlePaymentButtonClick)}))},i.initActionButton=function(){i.actionButton=i._container.querySelector(".modal__actions .button"),i.actionButton.addEventListener("click",i.handleSubmitButtonClick)},i.handlePaymentButtonClick=function(e){e.preventDefault();var t=e.currentTarget,r=i.formControls.querySelector("cash"===t.name?'button[name="card"]':'button[name="cash"]');i.events.emit("form:input",{value:t.name,name:"payment"}),i.updatePaymentButtonState(t,r)},i.updatePaymentButtonState=function(e,t){e.setAttribute("checked","true"),e.classList.add("button_alt-active"),t.setAttribute("checked","false"),t.classList.remove("button_alt-active")},i.handleFormElementInput=function(e){var t=e.target;t&&t.name&&i.events.emit("form:input",{value:t.value,name:t.name})},i.handleSubmitButtonClick=function(e){e.preventDefault(),"buy-button"===i.actionButton.id&&i.closeModal(),console.log(1),i.events.emit("order:submit"),i.cleanupPaymentButtons(),i.removeAllEventListeners()},i.cleanupPaymentButtons=function(){i._container.querySelectorAll(".button_alt").forEach((function(e){e.removeEventListener("click",i.handlePaymentButtonClick)}))},i.removeAllEventListeners=function(){var e;null===(e=i.formElements)||void 0===e||e.forEach((function(e){e.removeEventListener("input",i.handleFormElementInput)})),i.cleanupPaymentButtons(),i.actionButton&&i.actionButton.removeEventListener("click",i.handleSubmitButtonClick)},i._container=i._container.querySelector(".modal__content"),i}return function form_view_createClass(e,t,r){return t&&form_view_defineProperties(e.prototype,t),r&&form_view_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(FormView,[{key:"errors",set:function set(e){var t=this._container.querySelector(".form__errors");t&&(t.innerHTML="",e.forEach((function(e){var r=document.createElement("p");r.textContent=e,t.appendChild(r)})))}},{key:"isSubmit",set:function set(e){this.setDisabled(this.actionButton,!e)}}]),FormView}(s);function form_model_typeof(e){return form_model_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},form_model_typeof(e)}function form_model_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function form_model_toPrimitive(e,t){if("object"!==form_model_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==form_model_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===form_model_typeof(i)?i:String(i)),o)}var n,i}var L={payment:"",email:"",phone:"",address:"",items:[""],total:0},V=/^[^@]+@[^@]+\.[^@]+$/,I=/^((8|\+7)[- ]?)?(\(?\d{3}\)?[- ]?)?[\d\- ]{7,10}$/,R=function(){function FormModel(e){!function form_model_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,FormModel),this._events=e,this._orderData=L,this._currentForm="order"}return function form_model_createClass(e,t,r){return t&&form_model_defineProperties(e.prototype,t),r&&form_model_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(FormModel,[{key:"currentForm",get:function get(){return this._currentForm}},{key:"updateForm",value:function updateForm(e){this._currentForm=e}},{key:"events",get:function get(){return this._events}},{key:"orderData",get:function get(){return this._orderData}},{key:"errors",get:function get(){return this._errors},set:function set(e){this._errors=e}},{key:"clear",value:function clear(){this._orderData=L}},{key:"input",value:function input(e){throw new Error("Method not implemented.")}},{key:"isReady",value:function isReady(){switch(this._currentForm){case"order":return!!this.orderData.payment&&!!this.orderData.address;case"contact":return!!this.orderData.phone.match(I)&&!!this.orderData.email.match(V)}}},{key:"validate",value:function validate(e,t){switch(this._errors=[],e?this._errors=this.errors.filter((function(e){return"Поле не должно быть пустым"===e})):this.errors.push("Поле не должно быть пустым"),t){case"phone":e.match(I)?this._errors=this._errors.filter((function(e){return"Неправильно введен телефон"===e})):this._errors.push("Неправильно введен телефон");break;case"email":e.match(V)?this._errors=this._errors.filter((function(e){return"Неправильно введена почта"===e})):this._errors.push("Неправильно введена почта")}return this.orderData[t]=e,this._errors}},{key:"postOrder",value:function postOrder(){return a.post("/order",this.orderData)}}]),FormModel}();function resultView_typeof(e){return resultView_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},resultView_typeof(e)}function resultView_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function resultView_toPrimitive(e,t){if("object"!==resultView_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==resultView_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===resultView_typeof(i)?i:String(i)),o)}var n,i}function resultView_setPrototypeOf(e,t){return resultView_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function _setPrototypeOf(e,t){return e.__proto__=t,e},resultView_setPrototypeOf(e,t)}function resultView_createSuper(e){var t=function resultView_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var r,o=resultView_getPrototypeOf(e);if(t){var n=resultView_getPrototypeOf(this).constructor;r=Reflect.construct(o,arguments,n)}else r=o.apply(this,arguments);return function resultView_possibleConstructorReturn(e,t){if(t&&("object"===resultView_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return resultView_assertThisInitialized(e)}(this,r)}}function resultView_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function resultView_getPrototypeOf(e){return resultView_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},resultView_getPrototypeOf(e)}var F,__classPrivateFieldSet=function(e,t,r,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,r):n?n.value=r:t.set(e,r),r},resultView_classPrivateFieldGet=function(e,t,r,o){if("a"===r&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?o:"a"===r?o.call(e):o?o.value:t.get(e)},A=".order-success__description",G=".order-success__close",B=function(e){!function resultView_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&resultView_setPrototypeOf(e,t)}(ResultView,e);var t=resultView_createSuper(ResultView);function ResultView(e,r,o){var n;return function resultView_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,ResultView),n=t.call(this,e,r,o),F.set(resultView_assertThisInitialized(n),void 0),n.handleFormClose=function(){n.closeModal()},n._container=e.querySelector(".modal__content"),n}return function resultView_createClass(e,t,r){return t&&resultView_defineProperties(e.prototype,t),r&&resultView_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(ResultView,[{key:"total",set:function set(e){var t=this;this.container.innerHTML="",this._container.appendChild(this._template),__classPrivateFieldSet(this,F,this._container.querySelector(G),"f"),resultView_classPrivateFieldGet(this,F,"f").addEventListener("click",(function(){return t.handleFormClose()})),this.setText(this.container.querySelector(A),"Списано "+e+" Синапсов"),console.log(1),this.openModal()}}]),ResultView}(s);function page_typeof(e){return page_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},page_typeof(e)}function page_defineProperties(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(n=o.key,i=void 0,i=function page_toPrimitive(e,t){if("object"!==page_typeof(e)||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var o=r.call(e,t||"default");if("object"!==page_typeof(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(n,"string"),"symbol"===page_typeof(i)?i:String(i)),o)}var n,i}F=new WeakMap;var q=document.querySelector(".modal"),N={container:document.querySelector(".gallery"),template:cloneTemplate("#card-catalog")},D={template:cloneTemplate("#card-preview")},z={template:cloneTemplate("#basket")},H={orderTemplate:cloneTemplate("#order"),contactTemplate:cloneTemplate("#contacts"),buttonNext:".order__button",buttonSubmit:".button"},W=cloneTemplate("#success"),Y=function(){function Page(){!function page_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,Page),this.broker=new u,this.cardModel=null,this.cardView=null,this.formView=null,this.successView=null,this.productsModel=new c(this.broker),this.productsView=new i(N.container,this.broker,N.template),this.cartModel=new p(this.broker),this.cartView=new T(q,this.broker,z.template),this.formModel=new R(this.broker),this.formView=new M(q,this.broker,H.orderTemplate,H.orderTemplate.querySelector(H.buttonNext)),this.successView=new B(q,this.broker,W),this.setupEventHandlers()}return function page_createClass(e,t,r){return t&&page_defineProperties(e.prototype,t),r&&page_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}(Page,[{key:"setupEventHandlers",value:function setupEventHandlers(){var e=this;this.broker.on("products:get",(function(){e.productsView.render(e.productsModel.products)})),this.broker.on("card:open",(function(t){e.cardModel&&e.cardView||(e.cardModel=new d(e.broker),e.cardView=new f(q,e.broker,D.template));var r=e.cardView,o=e.cardModel;r.renderLoading(),r.openModal(),o.getCard(t.id).then((function(t){r.setInCart(e.cartModel.products.some((function(e){return e.id===t.id}))),r.render(t)})).finally((function(){r.stopLoading()}))})),this.broker.on("cart:open",(function(){e.cartView.render({products:e.cartModel.products}),e.cartView.update(e.cartModel.products.length,e.cartModel.total),e.cartView.openModal()})),this.broker.on("cart:add",(function(t){new d(e.broker).getCard(t.id).then((function(t){var r={title:t.title,id:t.id,price:t.price};e.cartModel.add(r),e.cartView.update(e.cartModel.products.length,e.cartModel.total)}))})),this.broker.on("cart:remove",(function(t){e.cartModel.remove(t.id),e.cartView.container.querySelector(".card_full")||e.cartView.removeCard(t.id),e.cartView.update(e.cartModel.products.length,e.cartModel.total)})),this.broker.on("order:create",(function(){e.formView.renderForm(),e.formModel.orderData.items=e.cartModel.products.map((function(e){return e.id})),e.formModel.orderData.total=e.cartModel._total})),this.broker.on("form:input",(function(t){console.log(t);var r=e.formModel.validate(t.value,t.name);r.length&&e.formView.render({errors:r,isSubmit:!1}),e.formModel.isReady()&&e.formView.render({errors:r,isSubmit:!0})})),this.broker.on("order:submit",(function(){"contact"!==e.formModel.currentForm?(e.formView.changeForm(H.contactTemplate,H.contactTemplate.querySelector(H.buttonSubmit)),e.formView.renderForm(),e.formModel.updateForm("contact")):e.formModel.postOrder().then((function(t){e.cartModel.clear(),e.formModel.clear(),e.cartView.update(0,0),e.formView.resetForm(H.orderTemplate,H.orderTemplate.querySelector(H.buttonNext)),e.successView.render(t),e.formModel.updateForm("order")}))}))}}]),Page}();new u,new Y})();
//# sourceMappingURL=main.js.map